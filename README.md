# 時間割作成システム 使い方ガイド

## 概要
個別指導塾の時間割（ブース表）を自動作成するツールです。
ブラウザで完結し、2つのExcelファイルを読み込むだけで講師を自動配置できます。

## ファイル構成
- **scheduler.html** - メインツール（これだけ使います）
- 元シートテンプレート.xlsx - 講師の提出シフトのテンプレート
- ブース表テンプレート.xlsx - ブース表のテンプレート

## 使い方（3ステップ）

### ① scheduler.htmlをブラウザで開く
`scheduler.html` をダブルクリックするか、ブラウザにドラッグ&ドロップします。

### ② 2つのExcelファイルを読み込む
1. **ブース表（.xlsx）を選択**
   - ファイル選択ボタンをクリックしてブース表を選択
   - 自動的に読み込まれます（「✓ 読み込み完了」と表示されます）

2. **元シート（講師表 .xlsx）を選択**
   - ファイル選択ボタンをクリックして元シートを選択
   - 自動的に読み込まれます（「✓ 読み込み完了」と表示されます）

### ③ 講師を割り当てて保存
1. **「③ 講師を割り当てる」ボタンをクリック**
   - 自動的に講師が配置されます

2. **「講師配置済みブース表.xlsxを保存」ボタンをクリック**
   - ブース表形式のExcelファイルがダウンロードされます

### 完了！
ダウンロードされたExcelファイルを開いて、講師の配置を確認してください。

## 追加機能

### 割当結果プレビュー
「プレビューを表示/非表示」ボタンをクリックすると、ブラウザ上で割当結果を確認できます。
- 緑色のセル: 講師が配置済み
- 黄色のセル: 講師が未配置

### 詳細設定・その他の出力
割当実行後に「詳細設定・その他の出力を表示」ボタンが表示されます。
クリックすると以下の機能が使えます:
- **検知レポート**: 未割当や警告の一覧（CSV保存可）
- **CSV出力**: 詳細データ（CSV保存可）
- **実行ログ**: 再現用のログ（JSON保存可）
- **生徒配置済みブース表**: 生徒情報も含めた表（Excel保存可）

## Excel ファイルの形式

### ブース表の形式
- **行0**: 日(1〜31の数値)
- **行1**: 曜日(月/火/水/木/金/土/日/祝)
- **B列(2列目)**: 時刻(空欄の場合は直前の時刻を継承)
- **交点セル**: 丸数字(①〜⑳)でブース番号を表現

例:
```
     | B(時間) | C  | D  | E  | ...
-----|---------|----|----|----|-----
  0  |         | 3  | 3  | 4  | ...  (日)
  1  |         | 月 | 月 | 火 | ...  (曜日)
  2  | 14:30   | ① | ② | ① | ...
  3  |         | ③ | ④ |    | ...
  4  | 15:00   | ① |    | ② | ...
```

### 元シート(講師表)の形式
- **ヘッダ行**(先頭10行内): 各日の日付セル(右隣列が講師名列)
- **A列(1列目)**: 時刻(空欄の場合は直前の時刻を継承)
- **講師名セル**: 空でなければ、その日時に講師が可用

例:
```
     | A(時間) | B(日付)  | C(講師) | D(日付)  | E(講師) | ...
-----|---------|----------|---------|----------|---------|-----
  0  |         | 11/03    |         | 11/04    |         | ...
  1  | 14:30   |          | 山田    |          | 佐藤    | ...
  2  | 15:00   |          | 山田    |          |         | ...
  3  | 15:30   |          |         |          | 佐藤    | ...
```

## トラブルシューティング

### 「ブース表を先に読み込んでください」と表示される
→ ブース表のExcelファイルを選択してください。

### 「元シート（講師表）を先に読み込んでください」と表示される
→ 元シートのExcelファイルを選択してください。

### 年月の自動検出に失敗する
→ ブース表のシート名に「2025.11」のような年月情報が含まれているか確認してください。
→ または、ブース表内の上部セルに「2025/11」や「2025年11月」などの表記があるか確認してください。

### 講師が配置されないスロットがある
→ 「詳細設定・その他の出力を表示」をクリックして、検知レポートを確認してください。
→ 講師不足の可能性があります。

### Excelファイルが読み込めない
→ ファイル形式が .xlsx または .xls であることを確認してください。
→ ブラウザのコンソール（F12キー）でエラーメッセージを確認してください。

### 丸数字が正しく認識されない
→ ブース表で使用している丸数字が①〜⑳（U+2460〜U+2473）であることを確認してください。

## 割当ルール

システムは以下のルールで講師を自動配置します:
1. 同一日時のスロットに、空いている講師を1:1で割当
2. 講師の同時刻の重複割当は禁止
3. 各日に少ない回数の講師から優先的に割当

## よくある質問

### Q: 生徒情報も入力できますか？
A: はい。「詳細設定・その他の出力を表示」から「生徒配置済みブース表.xlsx」を保存できます。ただし、現在のシンプル版では生徒情報の入力機能は省略されています。

### Q: 講師の制約（NG生徒、連続勤務上限など）を設定できますか？
A: 将来のバージョンで対応予定です。現在は基本的な自動配置のみをサポートしています。

### Q: 手動で微調整できますか？
A: 出力されたExcelファイルを開いて、手動で講師の配置を変更できます。

### Q: index.htmlやteachers_list.htmlは必要ですか？
A: いいえ、scheduler.htmlだけで完結します。他のファイルは開発・デバッグ用です。

## 更新履歴
- v2.0: UIを大幅に簡略化（2025-01）
  - 2つのExcelファイルを読み込むだけで使用可能に
  - 不要な機能（JSON入力、年月指定、生徒需要入力）を削除
  - 用語を分かりやすく変更
- v1.1: Excel直接読み込み機能、プレビュー機能、レポート機能を追加
- v1.0: 初版リリース
