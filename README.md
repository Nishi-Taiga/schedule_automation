# ブース表自動生成ツール

個別指導塾のブース(座席)スケジュールを自動生成するWebアプリケーションです。
生徒の希望・NG条件・講師指導科目などの制約を考慮し、1か月分のスケジュールを一括生成します。

## 使い方

### Step 1: ファイルアップロード

ログイン後、2つのExcelファイル(.xlsx)をアップロードします。

| ファイル | 内容 |
|---------|------|
| **ブース表元シート** | 各週の講師出勤データ(4シート) |
| **ブース表** | 生徒データ・講師スキル・ブース希望・週テンプレート |

ドラッグ&ドロップまたはクリックでファイルを選択し、「次へ」で進みます。

### Step 2: 設定

#### 教室業務・チューター担当
曜日ごとに教室業務(事務)を担当する講師を設定します。
デフォルト値が入っていますが、ドロップダウンから変更可能です。
「＋」ボタンで候補を追加、「✕」で削除できます。

#### 講師ブース希望
講師ごとに優先的に使うブース番号(①〜⑥)を設定します。
ブース表の「講師ブース希望」シートから自動読み込みされます。

設定が完了したら「🚀 スケジュール生成」をクリックします。

### Step 3: 結果確認・手動編集

生成結果が表示されます。上部に配置率(例: 450/500コマ 90.0%)が表示されます。

#### タブ切り替え
- **第1週〜最終週**: 週ごとのブース表を表示
- **未配置**: スケジュールに入りきらなかったコマの一覧
- **📅 生徒別**: 生徒ごとの個人カレンダー表示

#### ブース表の見方
- 縦軸: 時間帯(16:00〜20:20 / 土曜は14:55〜18:10)
- 横軸: 曜日(月〜土) × ブース(最大6)
- 各セルに講師名と生徒チップ(学年・名前・科目)が表示されます
- 赤色のチップ: NG制約に違反している配置(NG講師・NG生徒が隣接)

#### ドラッグ&ドロップ操作
- **講師名をドラッグ**: 同じ曜日の別ブースの講師と入れ替え
- **生徒チップをドラッグ**: 別のブースへ移動(ブースが満席の場合は交換する生徒を選択)
- **未配置ゾーンへドロップ**: スケジュールから外して未配置に戻す
- **未配置から空きブースへドロップ**: 未配置の生徒をスケジュールに追加

#### 生徒別カレンダー
- 生徒チップをクリックすると、その生徒の4週間カレンダーが開きます
- カレンダー内の授業をクリックすると、講師や時間帯を変更できます
- カレンダー内の授業を別の日にドラッグして移動できます

#### ダウンロード
手動編集が完了したら「📥 ブース表DL」をクリックすると、`時間割_出力.xlsx` がダウンロードされます。
元のブース表テンプレートにスケジュールが書き込まれ、「未配置コマ」シートが追加されます。

## 入力ファイルの形式

### ブース表 (booth_XXXX.xlsx)

以下のシートが必要です。

#### 「必要コマ数」シート — 生徒データ
| 列 | 内容 | 例 |
|----|------|-----|
| B | 学年コード | S1, C2, K3 |
| D | 生徒名 | 山田太郎 |
| E〜U | 科目ごとの必要コマ数 | 2 |
| W | 希望講師 | 田中T,鈴木T |
| X | NG講師 | 石破T |
| Y | NG生徒 | 鈴木花子 |
| Z | 通塾可能時間帯 | 月16-20,火16-18 |
| AA | NG日程 | 2/5,2/19-2/25 |
| AB | 固定授業 | 月16:英,木19:数 |

#### 「一覧表」(または「指導可能」)シート — 講師スキル
- B列: 講師名(フルネーム)
- C〜T列以降: 指導可能な科目に「◯」を記入

#### 「講師ブース希望」シート — ブース割り当て
- A列: 講師名、B列: ブース番号(1〜6)

#### 週テンプレートシート(4～6枚)
- 出力時にスケジュールが書き込まれるテンプレートです

### ブース表元シート (元データ.xlsx)

4～6シート(各週1枚)で構成され、各シートに講師の出勤情報が入っています。
曜日ごとの列と時間帯ごとの行に、出勤する講師の短縮名が記載されています。

## 注意事項

- アップロード上限: 10MB
- セッションは1時間で期限切れ
- ファイルは一時保存のため、サーバー再起動で消去されます
